{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import backend_url from'../config/config';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Departments=()=>{const[departments,setDepartments]=useState([]);const[branches,setBranches]=useState([]);const[newDepartment,setNewDepartment]=useState('');const[selectedBranch,setSelectedBranch]=useState('');const[showModal,setShowModal]=useState(false);const[editMode,setEditMode]=useState(false);const[currentDepartmentId,setCurrentDepartmentId]=useState(null);// Fetch departments\nconst fetchDepartments=async()=>{const res=await axios.get(\"\".concat(backend_url,\"/departments\"));setDepartments(res.data);};// Fetch branches\nconst fetchBranches=async()=>{const res=await axios.get(\"\".concat(backend_url,\"/branch\"));setBranches(res.data);};useEffect(()=>{fetchDepartments();fetchBranches();},[]);const handleAddDepartment=async()=>{if(newDepartment.trim()&&selectedBranch){await axios.post(\"\".concat(backend_url,\"/departments\"),{name:newDepartment,branch:selectedBranch});resetForm();fetchDepartments();}};const handleUpdateDepartment=async()=>{if(newDepartment.trim()&&currentDepartmentId&&selectedBranch){await axios.put(\"\".concat(backend_url,\"/departments/\").concat(currentDepartmentId),{name:newDepartment,branch:selectedBranch});resetForm();fetchDepartments();}};const handleDelete=async id=>{if(window.confirm(\"Are you sure you want to delete this department?\")){await axios.delete(\"\".concat(backend_url,\"/departments/\").concat(id));fetchDepartments();}};const openEditModal=dept=>{var _dept$branch;setEditMode(true);setCurrentDepartmentId(dept._id);setNewDepartment(dept.name);setSelectedBranch(((_dept$branch=dept.branch)===null||_dept$branch===void 0?void 0:_dept$branch._id)||'');setShowModal(true);};const resetForm=()=>{setNewDepartment('');setSelectedBranch('');setCurrentDepartmentId(null);setEditMode(false);setShowModal(false);};return/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 z-10\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold\",children:\"Departments\"}),/*#__PURE__*/_jsx(\"button\",{className:\"bg-[#735dff] text-white px-4 py-2 rounded\",onClick:()=>setShowModal(true),children:\"Add Department\"})]}),showModal&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-40 flex justify-center items-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded shadow-md w-1/3\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold mb-4\",children:editMode?'Edit Department':'Add New Department'}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:newDepartment,onChange:e=>setNewDepartment(e.target.value),placeholder:\"Enter department name\",className:\"w-full border p-2 mb-4 rounded\"}),/*#__PURE__*/_jsxs(\"select\",{value:selectedBranch,onChange:e=>setSelectedBranch(e.target.value),className:\"w-full border p-2 mb-4 rounded\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Branch\"}),branches.map(branch=>/*#__PURE__*/_jsx(\"option\",{value:branch._id,children:branch.name},branch._id))]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:resetForm,className:\"text-gray-500\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:editMode?handleUpdateDepartment:handleAddDepartment,className:\"bg-green-500 text-white px-4 py-2 rounded\",children:editMode?'Update':'Save'})]})]})}),/*#__PURE__*/_jsxs(\"table\",{className:\"min-w-full bg-white border mt-4\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"py-2 border-b\",children:\"#\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-2 border-b\",children:\"Department Name\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-2 border-b\",children:\"Branch\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-2 border-b\",children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:departments.map((dept,index)=>{var _dept$branch2;return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{className:\"py-2 border-b text-center\",children:index+1}),/*#__PURE__*/_jsx(\"td\",{className:\"py-2 border-b text-center\",children:dept.name}),/*#__PURE__*/_jsx(\"td\",{className:\"py-2 border-b text-center\",children:((_dept$branch2=dept.branch)===null||_dept$branch2===void 0?void 0:_dept$branch2.name)||'N/A'}),/*#__PURE__*/_jsxs(\"td\",{className:\"py-2 border-b text-center space-x-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>openEditModal(dept),className:\"text-[#735dff] hover:underline\",children:\"Edit\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDelete(dept._id),className:\"text-red-500 hover:underline\",children:\"Delete\"})]})]},dept._id);})})]})]});};export default Departments;","map":{"version":3,"names":["React","useState","useEffect","axios","backend_url","jsx","_jsx","jsxs","_jsxs","Departments","departments","setDepartments","branches","setBranches","newDepartment","setNewDepartment","selectedBranch","setSelectedBranch","showModal","setShowModal","editMode","setEditMode","currentDepartmentId","setCurrentDepartmentId","fetchDepartments","res","get","concat","data","fetchBranches","handleAddDepartment","trim","post","name","branch","resetForm","handleUpdateDepartment","put","handleDelete","id","window","confirm","delete","openEditModal","dept","_dept$branch","_id","className","children","onClick","type","value","onChange","e","target","placeholder","map","index","_dept$branch2"],"sources":["C:/Users/Dev/Desktop/Project/frontend/src/pages/Departments.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport backend_url from '../config/config';\r\n\r\nconst Departments = () => {\r\n  const [departments, setDepartments] = useState([]);\r\n  const [branches, setBranches] = useState([]);\r\n  const [newDepartment, setNewDepartment] = useState('');\r\n  const [selectedBranch, setSelectedBranch] = useState('');\r\n  const [showModal, setShowModal] = useState(false);\r\n  const [editMode, setEditMode] = useState(false);\r\n  const [currentDepartmentId, setCurrentDepartmentId] = useState(null);\r\n\r\n  // Fetch departments\r\n  const fetchDepartments = async () => {\r\n    const res = await axios.get(`${backend_url}/departments`);\r\n    setDepartments(res.data);\r\n  };\r\n\r\n  // Fetch branches\r\n  const fetchBranches = async () => {\r\n    const res = await axios.get(`${backend_url}/branch`);\r\n    setBranches(res.data);\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchDepartments();\r\n    fetchBranches();\r\n  }, []);\r\n\r\n  const handleAddDepartment = async () => {\r\n    if (newDepartment.trim() && selectedBranch) {\r\n      await axios.post(`${backend_url}/departments`, {\r\n        name: newDepartment,\r\n        branch: selectedBranch,\r\n      });\r\n      resetForm();\r\n      fetchDepartments();\r\n    }\r\n  };\r\n\r\n  const handleUpdateDepartment = async () => {\r\n    if (newDepartment.trim() && currentDepartmentId && selectedBranch) {\r\n      await axios.put(`${backend_url}/departments/${currentDepartmentId}`, {\r\n        name: newDepartment,\r\n        branch: selectedBranch,\r\n      });\r\n      resetForm();\r\n      fetchDepartments();\r\n    }\r\n  };\r\n\r\n  const handleDelete = async (id) => {\r\n    if (window.confirm(\"Are you sure you want to delete this department?\")) {\r\n      await axios.delete(`${backend_url}/departments/${id}`);\r\n      fetchDepartments();\r\n    }\r\n  };\r\n\r\n  const openEditModal = (dept) => {\r\n    setEditMode(true);\r\n    setCurrentDepartmentId(dept._id);\r\n    setNewDepartment(dept.name);\r\n    setSelectedBranch(dept.branch?._id || '');\r\n    setShowModal(true);\r\n  };\r\n\r\n  const resetForm = () => {\r\n    setNewDepartment('');\r\n    setSelectedBranch('');\r\n    setCurrentDepartmentId(null);\r\n    setEditMode(false);\r\n    setShowModal(false);\r\n  };\r\n\r\n  return (\r\n    <div className=\"p-4 z-10\">\r\n      <div className=\"flex justify-between items-center mb-4\">\r\n        <h2 className=\"text-xl font-bold\">Departments</h2>\r\n        <button\r\n          className=\"bg-[#735dff] text-white px-4 py-2 rounded\"\r\n          onClick={() => setShowModal(true)}\r\n        >\r\n          Add Department\r\n        </button>\r\n      </div>\r\n\r\n      {showModal && (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-40 flex justify-center items-center\">\r\n          <div className=\"bg-white p-6 rounded shadow-md w-1/3\">\r\n            <h3 className=\"text-lg font-semibold mb-4\">\r\n              {editMode ? 'Edit Department' : 'Add New Department'}\r\n            </h3>\r\n\r\n            <input\r\n              type=\"text\"\r\n              value={newDepartment}\r\n              onChange={(e) => setNewDepartment(e.target.value)}\r\n              placeholder=\"Enter department name\"\r\n              className=\"w-full border p-2 mb-4 rounded\"\r\n            />\r\n\r\n            <select\r\n              value={selectedBranch}\r\n              onChange={(e) => setSelectedBranch(e.target.value)}\r\n              className=\"w-full border p-2 mb-4 rounded\"\r\n            >\r\n              <option value=\"\">Select Branch</option>\r\n              {branches.map((branch) => (\r\n                <option key={branch._id} value={branch._id}>\r\n                  {branch.name}\r\n                </option>\r\n              ))}\r\n            </select>\r\n\r\n            <div className=\"flex justify-end gap-2\">\r\n              <button onClick={resetForm} className=\"text-gray-500\">\r\n                Cancel\r\n              </button>\r\n              <button\r\n                onClick={editMode ? handleUpdateDepartment : handleAddDepartment}\r\n                className=\"bg-green-500 text-white px-4 py-2 rounded\"\r\n              >\r\n                {editMode ? 'Update' : 'Save'}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      <table className=\"min-w-full bg-white border mt-4\">\r\n        <thead>\r\n          <tr>\r\n            <th className=\"py-2 border-b\">#</th>\r\n            <th className=\"py-2 border-b\">Department Name</th>\r\n            <th className=\"py-2 border-b\">Branch</th>\r\n            <th className=\"py-2 border-b\">Actions</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {departments.map((dept, index) => (\r\n            <tr key={dept._id}>\r\n              <td className=\"py-2 border-b text-center\">{index + 1}</td>\r\n              <td className=\"py-2 border-b text-center\">{dept.name}</td>\r\n              <td className=\"py-2 border-b text-center\">{dept.branch?.name || 'N/A'}</td>\r\n              <td className=\"py-2 border-b text-center space-x-2\">\r\n                <button\r\n                  onClick={() => openEditModal(dept)}\r\n                  className=\"text-[#735dff] hover:underline\"\r\n                >\r\n                  Edit\r\n                </button>\r\n                <button\r\n                  onClick={() => handleDelete(dept._id)}\r\n                  className=\"text-red-500 hover:underline\"\r\n                >\r\n                  Delete\r\n                </button>\r\n              </td>\r\n            </tr>\r\n          ))}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Departments;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}